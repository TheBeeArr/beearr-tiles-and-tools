-- Grass Tool Edited by BeeArr#8231 // https://github.com/TheBeeArr/beearr-tiles-and-tools/ // GNU General Public License v3 (GPL-3)
PLANTS = {
	'd_streetcracks_1_24',
	'd_streetcracks_1_25',
	'd_streetcracks_1_26',
	'd_streetcracks_1_27',
	'd_streetcracks_1_28',
	'd_streetcracks_1_29',
	'd_streetcracks_1_30',
	'd_streetcracks_1_31',
	'd_streetcracks_1_32',
	'd_streetcracks_1_33',
	'd_streetcracks_1_34',
	'd_streetcracks_1_35',
	'd_streetcracks_1_36',
	'd_streetcracks_1_37',
	'd_streetcracks_1_38',
	'd_streetcracks_1_39',
	'd_streetcracks_1_40',
	'd_streetcracks_1_41',
	'd_streetcracks_1_42',
	'd_streetcracks_1_43',
	'd_streetcracks_1_44',
	'd_streetcracks_1_45',
	'd_streetcracks_1_46',
	'd_streetcracks_1_47',
	'd_streetcracks_1_48',
	'd_streetcracks_1_49',
	'd_streetcracks_1_50',
	'd_streetcracks_1_51',
	'd_streetcracks_1_52',
	'd_streetcracks_1_53',
	'd_streetcracks_1_54',
	'd_streetcracks_1_55',
	'd_streetcracks_1_56',
	'd_streetcracks_1_57',
	'd_streetcracks_1_58',
	'd_streetcracks_1_59',
	'd_streetcracks_1_60',
	'd_streetcracks_1_61',
	'd_streetcracks_1_62',
	'd_streetcracks_1_63',
	'd_streetcracks_1_64',
	'd_streetcracks_1_65',
	'd_streetcracks_1_66',
	'd_streetcracks_1_67',
	'd_streetcracks_1_68',
	'd_streetcracks_1_69',
	'd_streetcracks_1_70',
	'd_streetcracks_1_71',
	'd_streetcracks_1_72',
	'd_streetcracks_1_73',
	'd_streetcracks_1_74',
	'd_streetcracks_1_75',
	'd_streetcracks_1_76',
	'd_streetcracks_1_77',
	'd_streetcracks_1_78',
	'd_streetcracks_1_79',
	'd_streetcracks_1_80',
	'd_streetcracks_1_81',
	'd_streetcracks_1_82',
	'd_streetcracks_1_83',
	'd_streetcracks_1_84',
	'd_streetcracks_1_85',
	'd_streetcracks_1_86',
	'd_streetcracks_1_87',
	'd_streetcracks_1_88',
	'd_streetcracks_1_89',
	'd_streetcracks_1_90',
	'd_streetcracks_1_91',
	'd_streetcracks_1_92',
	'd_streetcracks_1_93',
	'd_streetcracks_1_94',
	'd_streetcracks_1_95',
	'd_streetcracks_1_96',
	'd_streetcracks_1_97',
	'd_streetcracks_1_98',
	'd_streetcracks_1_99',
	'd_streetcracks_1_100',
	'd_streetcracks_1_101',
	'd_streetcracks_1_102',
	'd_streetcracks_1_103',
	'd_streetcracks_1_104',
	'd_streetcracks_1_105',
	'd_streetcracks_1_106',
	'd_streetcracks_1_107',
	'd_streetcracks_1_108',
	'd_streetcracks_1_109',
	'd_streetcracks_1_110',
	'd_streetcracks_1_111',
	'd_streetcracks_1_112',
	'd_streetcracks_1_113',
	'd_streetcracks_1_114',
	'd_streetcracks_1_115',
	'd_streetcracks_1_116',
	'd_streetcracks_1_117',
	'd_streetcracks_1_118',
	'd_streetcracks_1_119',
	'e_newgrass_1_0',
	'e_newgrass_1_1',
	'e_newgrass_1_2',
	'e_newgrass_1_3',
	'e_newgrass_1_4',
	'e_newgrass_1_5',
	'e_newgrass_1_6',
	'e_newgrass_1_7',
	'e_newgrass_1_8',
	'e_newgrass_1_9',
	'e_newgrass_1_10',
	'e_newgrass_1_11',
	'e_newgrass_1_12',
	'e_newgrass_1_13',
	'e_newgrass_1_14',
	'e_newgrass_1_15',
	'e_newgrass_1_16',
	'e_newgrass_1_17',
	'e_newgrass_1_18',
	'e_newgrass_1_19',
	'e_newgrass_1_20',
	'e_newgrass_1_21',
	'e_newgrass_1_22',
	'e_newgrass_1_23',
	'e_newgrass_1_24',
	'e_newgrass_1_25',
	'e_newgrass_1_26',
	'e_newgrass_1_27',
	'e_newgrass_1_28',
	'e_newgrass_1_29',
	'e_newgrass_1_30',
	'e_newgrass_1_31',
	'e_newgrass_1_32',
	'e_newgrass_1_33',
	'e_newgrass_1_34',
	'e_newgrass_1_35',
	'e_newgrass_1_36',
	'e_newgrass_1_37',
	'e_newgrass_1_38',
	'e_newgrass_1_39',
	'e_newgrass_1_40',
	'e_newgrass_1_41',
	'e_newgrass_1_42',
	'e_newgrass_1_43',
	'e_newgrass_1_44',
	'e_newgrass_1_45',
	'e_newgrass_1_46',
	'e_newgrass_1_47',
	'e_newgrass_1_48',
	'e_newgrass_1_49',
	'e_newgrass_1_50',
	'e_newgrass_1_51',
	'e_newgrass_1_52',
	'e_newgrass_1_53',
	'e_newgrass_1_54',
	'e_newgrass_1_55',
	'e_newgrass_1_56',
	'e_newgrass_1_57',
	'e_newgrass_1_58',
	'e_newgrass_1_59',
	'e_newgrass_1_60',
	'e_newgrass_1_61',
	'e_newgrass_1_62',
	'e_newgrass_1_63',
	'e_newgrass_1_64',
	'e_newgrass_1_65',
	'e_newgrass_1_66',
	'e_newgrass_1_67',
	'e_newgrass_1_68',
	'e_newgrass_1_69',
	'e_newgrass_1_70',
	'e_newgrass_1_71',
	'e_newgrass_1_72',
	'e_newgrass_1_73',
	'e_newgrass_1_74',
	'e_newgrass_1_75',
	'e_newgrass_1_76',
	'e_newgrass_1_77',
	'e_newgrass_1_78',
	'e_newgrass_1_79',
	'e_newgrass_1_80',
	'e_newgrass_1_81',
	'e_newgrass_1_82',
	'e_newgrass_1_83',
	'e_newgrass_1_84',
	'e_newgrass_1_85',
	'e_newgrass_1_86',
	'e_newgrass_1_87',
	'e_newgrass_1_88',
	'e_newgrass_1_89'
}


LAYERS = {
	'0_Vegetation',
	'0_Vegetation1'
}

function activate()
end

function deactivate()
end

function mouseMoved(buttons, x, y, modifiers)
	self:clearToolTiles()
	if x < 0 or y < 0 or x >= map:width() or y >= map:height() then
		self.ok = false
		return
	end

	CURRENT_PLANT = PLANTS[map:bmp(0):rand(x, y) % #PLANTS + 1]
	local tile = map:tile(CURRENT_PLANT)
	local layerName = pickEmptyLayer(x, y)
	if tile and layerName then
		self.ok = true
		self:setToolTile(layerName, x, y, tile)
	else
		self.ok = false
	end
end

function mousePressed(buttons, x, y, modifiers)
	if buttons.left then
		self.cancel = false
		self.x, self.y = x, y
	end
	if buttons.right then
		self.cancel = true
	end
end

function mouseReleased(buttons, x, y, modifiers)
	if buttons.left and self.ok and not self.cancel then
		local layerName = pickEmptyLayer(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(CURRENT_PLANT))
		self:applyChanges('Random Grass')
	end
end

function pickEmptyLayer(x, y)
	for _,layerName in ipairs(LAYERS) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

