-- Four Seasons Tree Tool Created by BeeArr#8231 // https://github.com/TheBeeArr/beearr-tiles-and-tools/ // GNU General Public License v3 (GPL-3)
spring = {
		{'e_americanlinden_1_0', 'e_americanlinden_1_8'},
		{'e_americanlinden_1_0', 'e_americanlinden_1_12'},
		{'e_americanlinden_1_1', 'e_americanlinden_1_9'},
		{'e_americanlinden_1_1', 'e_americanlinden_1_13'},
		{'e_americanlinden_1_2', 'e_americanlinden_1_10'},
		{'e_americanlinden_1_2', 'e_americanlinden_1_14'},
		{'e_americanlinden_1_3', 'e_americanlinden_1_11'},
		{'e_americanlinden_1_3', 'e_americanlinden_1_15'},
		{'e_carolinasilverbell_1_0', 'e_carolinasilverbell_1_8'},
		{'e_carolinasilverbell_1_0', 'e_carolinasilverbell_1_12'},
		{'e_carolinasilverbell_1_1', 'e_carolinasilverbell_1_9'},
		{'e_carolinasilverbell_1_1', 'e_carolinasilverbell_1_13'},
		{'e_carolinasilverbell_1_2', 'e_carolinasilverbell_1_10'},
		{'e_carolinasilverbell_1_2', 'e_carolinasilverbell_1_14'},
		{'e_carolinasilverbell_1_3', 'e_carolinasilverbell_1_11'},
		{'e_carolinasilverbell_1_3', 'e_carolinasilverbell_1_15'},
		{'e_cockspurhawthorn_1_0', 'e_cockspurhawthorn_1_8'},
		{'e_cockspurhawthorn_1_0', 'e_cockspurhawthorn_1_12'},
		{'e_cockspurhawthorn_1_1', 'e_cockspurhawthorn_1_9'},
		{'e_cockspurhawthorn_1_1', 'e_cockspurhawthorn_1_13'},
		{'e_cockspurhawthorn_1_2', 'e_cockspurhawthorn_1_10'},
		{'e_cockspurhawthorn_1_2', 'e_cockspurhawthorn_1_14'},
		{'e_cockspurhawthorn_1_3', 'e_cockspurhawthorn_1_11'},
		{'e_cockspurhawthorn_1_3', 'e_cockspurhawthorn_1_15'},
		{'e_dogwood_1_0', 'e_dogwood_1_8'},
		{'e_dogwood_1_0', 'e_dogwood_1_12'},
		{'e_dogwood_1_1', 'e_dogwood_1_9'},
		{'e_dogwood_1_1', 'e_dogwood_1_13'},
		{'e_dogwood_1_2', 'e_dogwood_1_10'},
		{'e_dogwood_1_2', 'e_dogwood_1_14'},
		{'e_dogwood_1_3', 'e_dogwood_1_11'},
		{'e_dogwood_1_3', 'e_dogwood_1_15'},
		{'e_easternredbud_1_0', 'e_easternredbud_1_8'},
		{'e_easternredbud_1_0', 'e_easternredbud_1_12'},
		{'e_easternredbud_1_1', 'e_easternredbud_1_9'},
		{'e_easternredbud_1_1', 'e_easternredbud_1_13'},
		{'e_easternredbud_1_2', 'e_easternredbud_1_10'},
		{'e_easternredbud_1_2', 'e_easternredbud_1_14'},
		{'e_easternredbud_1_3', 'e_easternredbud_1_11'},
		{'e_easternredbud_1_3', 'e_easternredbud_1_15'},
		{'e_redmaple_1_0', 'e_redmaple_1_8'},
		{'e_redmaple_1_0', 'e_redmaple_1_12'},
		{'e_redmaple_1_1', 'e_redmaple_1_9'},
		{'e_redmaple_1_1', 'e_redmaple_1_13'},
		{'e_redmaple_1_2', 'e_redmaple_1_10'},
		{'e_redmaple_1_2', 'e_redmaple_1_14'},
		{'e_redmaple_1_3', 'e_redmaple_1_11'},
		{'e_redmaple_1_3', 'e_redmaple_1_15'},
		{'e_riverbirch_1_0', 'e_riverbirch_1_8'},
		{'e_riverbirch_1_0', 'e_riverbirch_1_12'},
		{'e_riverbirch_1_1', 'e_riverbirch_1_9'},
		{'e_riverbirch_1_1', 'e_riverbirch_1_13'},
		{'e_riverbirch_1_2', 'e_riverbirch_1_10'},
		{'e_riverbirch_1_2', 'e_riverbirch_1_14'},
		{'e_riverbirch_1_3', 'e_riverbirch_1_11'},
		{'e_riverbirch_1_3', 'e_riverbirch_1_15'},
		{'e_yellowwood_1_0', 'e_yellowwood_1_8'},
		{'e_yellowwood_1_0', 'e_yellowwood_1_12'},
		{'e_yellowwood_1_1', 'e_yellowwood_1_9'},
		{'e_yellowwood_1_1', 'e_yellowwood_1_13'},
		{'e_yellowwood_1_2', 'e_yellowwood_1_10'},
		{'e_yellowwood_1_2', 'e_yellowwood_1_14'},
		{'e_yellowwood_1_3', 'e_yellowwood_1_11'},
		{'e_yellowwood_1_3', 'e_yellowwood_1_15'}
}

summer = {
		{'e_americanlinden_1_0', 'e_americanlinden_1_12'},
		{'e_americanlinden_1_1', 'e_americanlinden_1_13'},
		{'e_americanlinden_1_2', 'e_americanlinden_1_14'},
		{'e_americanlinden_1_3', 'e_americanlinden_1_15'},
		{'e_carolinasilverbell_1_0', 'e_carolinasilverbell_1_12'},
		{'e_carolinasilverbell_1_1', 'e_carolinasilverbell_1_13'},
		{'e_carolinasilverbell_1_2', 'e_carolinasilverbell_1_14'},
		{'e_carolinasilverbell_1_3', 'e_carolinasilverbell_1_15'},
		{'e_cockspurhawthorn_1_0', 'e_cockspurhawthorn_1_12'},
		{'e_cockspurhawthorn_1_1', 'e_cockspurhawthorn_1_13'},
		{'e_cockspurhawthorn_1_2', 'e_cockspurhawthorn_1_14'},
		{'e_cockspurhawthorn_1_3', 'e_cockspurhawthorn_1_15'},
		{'e_dogwood_1_0', 'e_dogwood_1_12'},
		{'e_dogwood_1_1', 'e_dogwood_1_13'},
		{'e_dogwood_1_2', 'e_dogwood_1_14'},
		{'e_dogwood_1_3', 'e_dogwood_1_15'},
		{'e_easternredbud_1_0', 'e_easternredbud_1_12'},
		{'e_easternredbud_1_1', 'e_easternredbud_1_13'},
		{'e_easternredbud_1_2', 'e_easternredbud_1_14'},
		{'e_easternredbud_1_3', 'e_easternredbud_1_15'},
		{'e_redmaple_1_0', 'e_redmaple_1_12'},
		{'e_redmaple_1_1', 'e_redmaple_1_13'},
		{'e_redmaple_1_2', 'e_redmaple_1_14'},
		{'e_redmaple_1_3', 'e_redmaple_1_15'},
		{'e_riverbirch_1_0', 'e_riverbirch_1_12'},
		{'e_riverbirch_1_1', 'e_riverbirch_1_13'},
		{'e_riverbirch_1_2', 'e_riverbirch_1_14'},
		{'e_riverbirch_1_3', 'e_riverbirch_1_15'},
		{'e_yellowwood_1_0', 'e_yellowwood_1_12'},
		{'e_yellowwood_1_1', 'e_yellowwood_1_13'},
		{'e_yellowwood_1_2', 'e_yellowwood_1_14'},
		{'e_yellowwood_1_3', 'e_yellowwood_1_15'}
}

autumn = {
		{'e_americanlinden_1_0', 'e_americanlinden_1_16'},
		{'e_americanlinden_1_0', 'e_americanlinden_1_20'},
		{'e_americanlinden_1_1', 'e_americanlinden_1_17'},
		{'e_americanlinden_1_1', 'e_americanlinden_1_21'},
		{'e_americanlinden_1_2', 'e_americanlinden_1_18'},
		{'e_americanlinden_1_2', 'e_americanlinden_1_22'},
		{'e_americanlinden_1_3', 'e_americanlinden_1_19'},
		{'e_americanlinden_1_3', 'e_americanlinden_1_23'},
		{'e_carolinasilverbell_1_0', 'e_carolinasilverbell_1_16'},
		{'e_carolinasilverbell_1_0', 'e_carolinasilverbell_1_20'},
		{'e_carolinasilverbell_1_1', 'e_carolinasilverbell_1_17'},
		{'e_carolinasilverbell_1_1', 'e_carolinasilverbell_1_21'},
		{'e_carolinasilverbell_1_2', 'e_carolinasilverbell_1_18'},
		{'e_carolinasilverbell_1_2', 'e_carolinasilverbell_1_22'},
		{'e_carolinasilverbell_1_3', 'e_carolinasilverbell_1_19'},
		{'e_carolinasilverbell_1_3', 'e_carolinasilverbell_1_23'},
		{'e_cockspurhawthorn_1_0', 'e_cockspurhawthorn_1_16'},
		{'e_cockspurhawthorn_1_0', 'e_cockspurhawthorn_1_20'},
		{'e_cockspurhawthorn_1_1', 'e_cockspurhawthorn_1_17'},
		{'e_cockspurhawthorn_1_1', 'e_cockspurhawthorn_1_21'},
		{'e_cockspurhawthorn_1_2', 'e_cockspurhawthorn_1_18'},
		{'e_cockspurhawthorn_1_2', 'e_cockspurhawthorn_1_22'},
		{'e_cockspurhawthorn_1_3', 'e_cockspurhawthorn_1_19'},
		{'e_cockspurhawthorn_1_3', 'e_cockspurhawthorn_1_23'},
		{'e_dogwood_1_0', 'e_dogwood_1_16'},
		{'e_dogwood_1_0', 'e_dogwood_1_20'},
		{'e_dogwood_1_1', 'e_dogwood_1_17'},
		{'e_dogwood_1_1', 'e_dogwood_1_21'},
		{'e_dogwood_1_2', 'e_dogwood_1_18'},
		{'e_dogwood_1_2', 'e_dogwood_1_22'},
		{'e_dogwood_1_3', 'e_dogwood_1_19'},
		{'e_dogwood_1_3', 'e_dogwood_1_23'},
		{'e_easternredbud_1_0', 'e_easternredbud_1_16'},
		{'e_easternredbud_1_0', 'e_easternredbud_1_20'},
		{'e_easternredbud_1_1', 'e_easternredbud_1_17'},
		{'e_easternredbud_1_1', 'e_easternredbud_1_21'},
		{'e_easternredbud_1_2', 'e_easternredbud_1_18'},
		{'e_easternredbud_1_2', 'e_easternredbud_1_22'},
		{'e_easternredbud_1_3', 'e_easternredbud_1_19'},
		{'e_easternredbud_1_3', 'e_easternredbud_1_23'},
		{'e_redmaple_1_0', 'e_redmaple_1_16'},
		{'e_redmaple_1_0', 'e_redmaple_1_20'},
		{'e_redmaple_1_1', 'e_redmaple_1_17'},
		{'e_redmaple_1_1', 'e_redmaple_1_21'},
		{'e_redmaple_1_2', 'e_redmaple_1_18'},
		{'e_redmaple_1_2', 'e_redmaple_1_22'},
		{'e_redmaple_1_3', 'e_redmaple_1_19'},
		{'e_redmaple_1_3', 'e_redmaple_1_23'},
		{'e_riverbirch_1_0', 'e_riverbirch_1_16'},
		{'e_riverbirch_1_0', 'e_riverbirch_1_20'},
		{'e_riverbirch_1_1', 'e_riverbirch_1_17'},
		{'e_riverbirch_1_1', 'e_riverbirch_1_21'},
		{'e_riverbirch_1_2', 'e_riverbirch_1_18'},
		{'e_riverbirch_1_2', 'e_riverbirch_1_22'},
		{'e_riverbirch_1_3', 'e_riverbirch_1_19'},
		{'e_riverbirch_1_3', 'e_riverbirch_1_23'},
		{'e_yellowwood_1_0', 'e_yellowwood_1_16'},
		{'e_yellowwood_1_0', 'e_yellowwood_1_20'},
		{'e_yellowwood_1_1', 'e_yellowwood_1_17'},
		{'e_yellowwood_1_1', 'e_yellowwood_1_21'},
		{'e_yellowwood_1_2', 'e_yellowwood_1_18'},
		{'e_yellowwood_1_2', 'e_yellowwood_1_22'},
		{'e_yellowwood_1_3', 'e_yellowwood_1_19'},
		{'e_yellowwood_1_3', 'e_yellowwood_1_23'}
}
	
winter = {
		{'e_americanlinden_1_0'},
		{'e_americanlinden_1_1'},
		{'e_americanlinden_1_2'},
		{'e_americanlinden_1_3'},
		{'e_americanlinden_1_4'},
		{'e_americanlinden_1_5'},
		{'e_americanlinden_1_6'},
		{'e_americanlinden_1_7'},
		{'e_carolinasilverbell_1_0'},
		{'e_carolinasilverbell_1_1'},
		{'e_carolinasilverbell_1_2'},
		{'e_carolinasilverbell_1_3'},
		{'e_carolinasilverbell_1_4'},
		{'e_carolinasilverbell_1_5'},
		{'e_carolinasilverbell_1_6'},
		{'e_carolinasilverbell_1_7'},
		{'e_cockspurhawthorn_1_0'},
		{'e_cockspurhawthorn_1_1'},
		{'e_cockspurhawthorn_1_2'},
		{'e_cockspurhawthorn_1_3'},
		{'e_cockspurhawthorn_1_4'},
		{'e_cockspurhawthorn_1_5'},
		{'e_cockspurhawthorn_1_6'},
		{'e_cockspurhawthorn_1_7'},
		{'e_dogwood_1_0'},
		{'e_dogwood_1_1'},
		{'e_dogwood_1_2'},
		{'e_dogwood_1_3'},
		{'e_dogwood_1_4'},
		{'e_dogwood_1_5'},
		{'e_dogwood_1_6'},
		{'e_dogwood_1_7'},
		{'e_easternredbud_1_0'},
		{'e_easternredbud_1_1'},
		{'e_easternredbud_1_2'},
		{'e_easternredbud_1_3'},
		{'e_easternredbud_1_4'},
		{'e_easternredbud_1_5'},
		{'e_easternredbud_1_6'},
		{'e_easternredbud_1_7'},
		{'e_redmaple_1_0'},
		{'e_redmaple_1_1'},
		{'e_redmaple_1_2'},
		{'e_redmaple_1_3'},
		{'e_redmaple_1_4'},
		{'e_redmaple_1_5'},
		{'e_redmaple_1_6'},
		{'e_redmaple_1_7'},
		{'e_riverbirch_1_0'},
		{'e_riverbirch_1_1'},
		{'e_riverbirch_1_2'},
		{'e_riverbirch_1_3'},
		{'e_riverbirch_1_4'},
		{'e_riverbirch_1_5'},
		{'e_riverbirch_1_6'},
		{'e_riverbirch_1_7'},
		{'e_yellowwood_1_0'},
		{'e_yellowwood_1_1'},
		{'e_yellowwood_1_2'},
		{'e_yellowwood_1_3'},
		{'e_yellowwood_1_4'},
		{'e_yellowwood_1_5'},
		{'e_yellowwood_1_6'},
		{'e_yellowwood_1_7'}
}


LAYER0 = {'0_Vegetation'}
LAYER1 = {'0_Vegetation1'}
	
function activate()
end

function deactivate()
end

function mouseMoved(buttons, x, y, modifiers)
	self:clearToolTiles()
	if x < 0 or y < 0 or x >= map:width() or y >= map:height() then
		self.ok = false
		return
	end
	if modifiers.alt then
		SPR0 = spring[map:bmp(0):rand(x, y) % #spring + 1][1]
			local tile = map:tile(SPR0)
			local layerName = pickEmptyLayer0(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end		
		SPR1 = spring[map:bmp(0):rand(x, y) % #spring + 1][2]
			local tile = map:tile(SPR1)
			local layerName = pickEmptyLayer1(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
	elseif modifiers.control then
		AU0 = autumn[map:bmp(0):rand(x, y) % #autumn + 1][1]
		local tile = map:tile(AU0)
		local layerName = pickEmptyLayer0(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
		AU1 = autumn[map:bmp(0):rand(x, y) % #autumn + 1][2]
		local tile = map:tile(AU1)
		local layerName = pickEmptyLayer1(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
	elseif modifiers.shift then
		WIN = winter[map:bmp(0):rand(x, y) % #winter + 1][1]
		local tile = map:tile(WIN)
		local layerName = pickEmptyLayer0(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
	else
		SUM0 = summer[map:bmp(0):rand(x, y) % #summer+ 1][1]
			local tile = map:tile(SUM0)
			local layerName = pickEmptyLayer0(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		SUM1 = summer[map:bmp(0):rand(x, y) % #summer+ 1][2]
			local tile = map:tile(SUM1)
			local layerName = pickEmptyLayer1(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		self.ok = false
	end
end

function mousePressed(buttons, x, y, modifiers)
	if buttons.left then
		self.cancel = false
		self.x, self.y = x, y
	end
	if buttons.right then
		self.cancel = true
	end
end

function mouseReleased(buttons, x, y, modifiers)
	if buttons.left and self.ok and not self.cancel then
	if modifiers.alt then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SPR0))
		self:applyChanges('Place Spring Tree')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SPR1))
		self:applyChanges('Place Spring Tree')
	end
	if modifiers.control then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(AU0))
		self:applyChanges('Place Autumn Tree')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(AU1))
		self:applyChanges('Place Autumn Tree')
	end
	if modifiers.shift then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(WIN))
		self:applyChanges('Place Winter Tree')
	end
	else
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SUM0))
		self:applyChanges('Place Summer Tree')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SUM1))
		self:applyChanges('Place Summer Tree')
	end
end

function pickEmptyLayer0(x, y)
	for _,layerName in ipairs(LAYER0) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

function pickEmptyLayer1(x, y)
	for _,layerName in ipairs(LAYER1) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

    
