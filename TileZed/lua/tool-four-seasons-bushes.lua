-- Four Seasons Bushes Tool Created by BeeArr#8231 // https://github.com/TheBeeArr/beearr-tiles-and-tools/ // GNU General Public License v3 (GPL-3)
spring = {
		{'d_plants_1_16', 'd_plants_1_24'},
		{'d_plants_1_17', 'd_plants_1_25'},
		{'d_plants_1_18', 'd_plants_1_26'},
		{'d_plants_1_19', 'd_plants_1_27'},
		{'d_plants_1_20', 'd_plants_1_28'},
		{'d_plants_1_21', 'd_plants_1_29'},
		{'d_plants_1_22', 'd_plants_1_30'},
		{'d_plants_1_23', 'd_plants_1_31'},
		{'d_plants_1_32', 'd_plants_1_40'},
		{'d_plants_1_33', 'd_plants_1_41'},
		{'d_plants_1_34', 'd_plants_1_42'},
		{'d_plants_1_35', 'd_plants_1_43'},
		{'d_plants_1_36', 'd_plants_1_44'},
		{'d_plants_1_37', 'd_plants_1_45'},
		{'d_plants_1_38', 'd_plants_1_46'},
		{'d_plants_1_39', 'd_plants_1_47'},
		{'d_plants_1_49', 'd_plants_1_57'},
		{'d_plants_1_50', 'd_plants_1_58'},
		{'d_plants_1_51', 'd_plants_1_59'},
		{'d_plants_1_52', 'd_plants_1_60'},
		{'d_plants_1_53', 'd_plants_1_61'},
		{'d_plants_1_54', 'd_plants_1_62'},
		{'d_plants_1_55', 'd_plants_1_63'},
		{'f_bushes_1_0', 'f_bushes_1_64'},
		{'f_bushes_1_0', 'f_bushes_1_32'},
		{'f_bushes_1_1', 'f_bushes_1_33'},
		{'f_bushes_1_2', 'f_bushes_1_34'},
		{'f_bushes_1_3', 'f_bushes_1_35'},
		{'f_bushes_1_4', 'f_bushes_1_36'},
		{'f_bushes_1_5', 'f_bushes_1_37'},
		{'f_bushes_1_6', 'f_bushes_1_38'},
		{'f_bushes_1_7', 'f_bushes_1_39'},
		{'f_bushes_1_8', 'f_bushes_1_40'},
		{'f_bushes_1_9', 'f_bushes_1_41'},
		{'f_bushes_1_10', 'f_bushes_1_42'},
		{'f_bushes_1_11', 'f_bushes_1_43'},
		{'f_bushes_1_12', 'f_bushes_1_44'},
		{'f_bushes_1_13', 'f_bushes_1_45'},
		{'f_bushes_1_14', 'f_bushes_1_46'},
		{'f_bushes_1_15', 'f_bushes_1_47'},
		{'f_bushes_1_7', 'f_bushes_1_71', 'f_bushes_1_87'},
		{'f_bushes_1_0', 'f_bushes_1_72', 'f_bushes_1_88'},
		{'f_bushes_1_1', 'f_bushes_1_73', 'f_bushes_1_89'},
		{'f_bushes_1_2', 'f_bushes_1_74', 'f_bushes_1_90'},
		{'f_bushes_1_3', 'f_bushes_1_75', 'f_bushes_1_91'},
		{'f_bushes_1_4', 'f_bushes_1_76', 'f_bushes_1_92'},
		{'f_bushes_1_5', 'f_bushes_1_77', 'f_bushes_1_93'},
		{'f_bushes_1_6', 'f_bushes_1_78', 'f_bushes_1_94'},
		{'f_bushes_1_7', 'f_bushes_1_79', 'f_bushes_1_95'},		
		{'f_bushes_1_8', 'f_bushes_1_97', 'f_bushes_1_113'},
		{'f_bushes_1_9', 'f_bushes_1_98', 'f_bushes_1_114'},
		{'f_bushes_1_10', 'f_bushes_1_99', 'f_bushes_1_115'},
		{'f_bushes_1_11', 'f_bushes_1_100', 'f_bushes_1_116'},
		{'f_bushes_1_12', 'f_bushes_1_101', 'f_bushes_1_117'},
		{'f_bushes_1_13', 'f_bushes_1_102', 'f_bushes_1_118'},
		{'f_bushes_1_14', 'f_bushes_1_103', 'f_bushes_1_119'},
		{'f_bushes_1_8', 'f_bushes_1_104', 'f_bushes_1_120'},
		{'f_bushes_1_9', 'f_bushes_1_105', 'f_bushes_1_121'},
		{'f_bushes_1_10', 'f_bushes_1_106', 'f_bushes_1_122'},
		{'f_bushes_1_11', 'f_bushes_1_107', 'f_bushes_1_123'},
		{'f_bushes_1_12', 'f_bushes_1_108', 'f_bushes_1_124'},
		{'f_bushes_1_13', 'f_bushes_1_109', 'f_bushes_1_125'},
		{'f_bushes_1_14', 'f_bushes_1_110', 'f_bushes_1_126'},
		{'f_bushes_1_15', 'f_bushes_1_111', 'f_bushes_1_127'}
}

summer = {
		{'f_bushes_1_0', 'f_bushes_1_64'},
		{'f_bushes_1_1', 'f_bushes_1_65'},
		{'f_bushes_1_2', 'f_bushes_1_66'},
		{'f_bushes_1_3', 'f_bushes_1_67'},
		{'f_bushes_1_4', 'f_bushes_1_68'},
		{'f_bushes_1_5', 'f_bushes_1_69'},
		{'f_bushes_1_6', 'f_bushes_1_70'},				
		{'f_bushes_1_7', 'f_bushes_1_71'},
		{'f_bushes_1_0', 'f_bushes_1_72'},
		{'f_bushes_1_1', 'f_bushes_1_73'},
		{'f_bushes_1_2', 'f_bushes_1_74'},
		{'f_bushes_1_3', 'f_bushes_1_75'},
		{'f_bushes_1_4', 'f_bushes_1_76'},
		{'f_bushes_1_5', 'f_bushes_1_77'},
		{'f_bushes_1_6', 'f_bushes_1_78'},
		{'f_bushes_1_7', 'f_bushes_1_79'},
		{'f_bushes_1_8', 'f_bushes_1_96'},
		{'f_bushes_1_9', 'f_bushes_1_97'},
		{'f_bushes_1_10', 'f_bushes_1_98'},
		{'f_bushes_1_11', 'f_bushes_1_99'},
		{'f_bushes_1_12', 'f_bushes_1_100'},
		{'f_bushes_1_13', 'f_bushes_1_101'},
		{'f_bushes_1_14', 'f_bushes_1_102'},
		{'f_bushes_1_15', 'f_bushes_1_103'},
		{'f_bushes_1_8', 'f_bushes_1_104'},
		{'f_bushes_1_9', 'f_bushes_1_105'},
		{'f_bushes_1_10', 'f_bushes_1_106'},
		{'f_bushes_1_11', 'f_bushes_1_107'},
		{'f_bushes_1_12', 'f_bushes_1_108'},
		{'f_bushes_1_13', 'f_bushes_1_109'},
		{'f_bushes_1_14', 'f_bushes_1_110'},
		{'f_bushes_1_15', 'f_bushes_1_111'},
		{'d_plants_1_0'},
		{'d_plants_1_1'},
		{'d_plants_1_2'},
		{'d_plants_1_3'},
		{'d_plants_1_4'},
		{'d_plants_1_5'},
		{'d_plants_1_6'},
		{'d_plants_1_7'},
		{'d_plants_1_16'},
		{'d_plants_1_17'},
		{'d_plants_1_18'},
		{'d_plants_1_19'},
		{'d_plants_1_20'},
		{'d_plants_1_21'},
		{'d_plants_1_22'},
		{'d_plants_1_23'},
		{'d_plants_1_32'},
		{'d_plants_1_33'},
		{'d_plants_1_34'},
		{'d_plants_1_35'},
		{'d_plants_1_36'},
		{'d_plants_1_37'},
		{'d_plants_1_38'},
		{'d_plants_1_39'},
		{'d_plants_1_48'},
		{'d_plants_1_49'},
		{'d_plants_1_50'},
		{'d_plants_1_51'},
		{'d_plants_1_52'},
		{'d_plants_1_53'},
		{'d_plants_1_54'},
		{'d_plants_1_55'}
}

autumn = {
		{'d_plants_1_8'},
		{'d_plants_1_9'},
		{'d_plants_1_10'},
		{'d_plants_1_11'},
		{'d_plants_1_12'},
		{'d_plants_1_13'},
		{'d_plants_1_14'},
		{'d_plants_1_15'},
		{'f_bushes_1_0', 'f_bushes_1_48'},
		{'f_bushes_1_1', 'f_bushes_1_49'},
		{'f_bushes_1_2', 'f_bushes_1_50'},
		{'f_bushes_1_3', 'f_bushes_1_51'},
		{'f_bushes_1_4', 'f_bushes_1_52'},
		{'f_bushes_1_5', 'f_bushes_1_53'},
		{'f_bushes_1_6', 'f_bushes_1_54'},
		{'f_bushes_1_7', 'f_bushes_1_55'},
		{'f_bushes_1_8', 'f_bushes_1_56'},
		{'f_bushes_1_9', 'f_bushes_1_57'},
		{'f_bushes_1_10', 'f_bushes_1_58'},
		{'f_bushes_1_11', 'f_bushes_1_59'},
		{'f_bushes_1_12', 'f_bushes_1_60'},
		{'f_bushes_1_13', 'f_bushes_1_61'},
		{'f_bushes_1_14', 'f_bushes_1_62'},
		{'f_bushes_1_15', 'f_bushes_1_63'}
}
	
winter = {
		{'f_bushes_1_0'},
		{'f_bushes_1_1'},
		{'f_bushes_1_2'},
		{'f_bushes_1_3'},
		{'f_bushes_1_4'},
		{'f_bushes_1_5'},
		{'f_bushes_1_6'},
		{'f_bushes_1_7'},
		{'f_bushes_1_8'},
		{'f_bushes_1_9'},
		{'f_bushes_1_10'},
		{'f_bushes_1_11'},
		{'f_bushes_1_12'},
		{'f_bushes_1_13'},
		{'f_bushes_1_14'},
		{'f_bushes_1_15'},
		{'f_bushes_1_16'},
		{'f_bushes_1_17'},
		{'f_bushes_1_18'},
		{'f_bushes_1_19'},
		{'f_bushes_1_20'},
		{'f_bushes_1_21'},
		{'f_bushes_1_22'},
		{'f_bushes_1_23'},
		{'f_bushes_1_24'},
		{'f_bushes_1_25'},
		{'f_bushes_1_26'},
		{'f_bushes_1_27'},
		{'f_bushes_1_28'},
		{'f_bushes_1_29'},
		{'f_bushes_1_30'},
		{'f_bushes_1_31'}
}


LAYER0 = {'0_Vegetation'}
LAYER1 = {'0_Vegetation1'}
LAYER2 = {'0_Vegetation2'}
	
function activate()
end

function deactivate()
end

function mouseMoved(buttons, x, y, modifiers)
	self:clearToolTiles()
	if x < 0 or y < 0 or x >= map:width() or y >= map:height() then
		self.ok = false
		return
	end
	if modifiers.alt then
		SPR0 = spring[map:bmp(0):rand(x, y) % #spring + 1][1]
			local tile = map:tile(SPR0)
			local layerName = pickEmptyLayer0(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end		
		SPR1 = spring[map:bmp(0):rand(x, y) % #spring + 1][2]
			local tile = map:tile(SPR1)
			local layerName = pickEmptyLayer1(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		SPR2 = spring[map:bmp(0):rand(x, y) % #spring + 1][3]
			local tile = map:tile(SPR2)
			local layerName = pickEmptyLayer2(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
	elseif modifiers.control then
		AU0 = autumn[map:bmp(0):rand(x, y) % #autumn + 1][1]
		local tile = map:tile(AU0)
		local layerName = pickEmptyLayer0(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
		AU1 = autumn[map:bmp(0):rand(x, y) % #autumn + 1][2]
		local tile = map:tile(AU1)
		local layerName = pickEmptyLayer1(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
	elseif modifiers.shift then
		WIN = winter[map:bmp(0):rand(x, y) % #winter + 1][1]
		local tile = map:tile(WIN)
		local layerName = pickEmptyLayer0(x, y)
		if tile and layerName then
			self.ok = true
			self:setToolTile(layerName, x, y, tile)
		end
	else
		SUM0 = summer[map:bmp(0):rand(x, y) % #summer+ 1][1]
			local tile = map:tile(SUM0)
			local layerName = pickEmptyLayer0(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		SUM1 = summer[map:bmp(0):rand(x, y) % #summer+ 1][2]
			local tile = map:tile(SUM1)
			local layerName = pickEmptyLayer1(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		SUM2 = summer[map:bmp(0):rand(x, y) % #summer+ 1][3]
			local tile = map:tile(SUM2)
			local layerName = pickEmptyLayer0(x, y)
			if tile and layerName then
				self.ok = true
				self:setToolTile(layerName, x, y, tile)
		end
		self.ok = false
	end
end

function mousePressed(buttons, x, y, modifiers)
	if buttons.left then
		self.cancel = false
		self.x, self.y = x, y
	end
	if buttons.right then
		self.cancel = true
	end
end

function mouseReleased(buttons, x, y, modifiers)
	if buttons.left and self.ok and not self.cancel then
	if modifiers.alt then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SPR0))
		self:applyChanges('Place Spring Bush')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SPR1))
		self:applyChanges('Place Spring Bush')
		local layerName = pickEmptyLayer2(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SPR2))
		self:applyChanges('Place Spring Bush')
	end
	if modifiers.control then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(AU0))
		self:applyChanges('Place Autumn Bush')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(AU1))
		self:applyChanges('Place Autumn Bush')
	end
	if modifiers.shift then
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(WIN))
		self:applyChanges('Place Winter Bush')
	end
	else
		local layerName = pickEmptyLayer0(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SUM0))
		self:applyChanges('Place Summer Bush')
		local layerName = pickEmptyLayer1(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SUM1))
		self:applyChanges('Place Summer Bush')
		local layerName = pickEmptyLayer2(x, y)
		map:tileLayer(layerName):setTile(self.x, self.y, map:tile(SUM2))
		self:applyChanges('Place Summer Bush')
	end
end

function pickEmptyLayer0(x, y)
	for _,layerName in ipairs(LAYER0) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

function pickEmptyLayer1(x, y)
	for _,layerName in ipairs(LAYER1) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

function pickEmptyLayer2(x, y)
	for _,layerName in ipairs(LAYER2) do
		local layer = map:tileLayer(layerName)
		if layer then
			local tile = layer:tileAt(x, y)
			if not tile then
				return layerName
			end
		end
	end
	return nil
end

    
